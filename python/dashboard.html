<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Dashboard ‚Äì Serveur Haute Performance</title>
  <style>
  :root {
    --bg-color: #fafafa;
    --text-color: #111111;
    --card-bg: #ffffff;
    --accent: #0d47a1;
    --accent-soft: #e3f2fd;
    --border-color: #cccccc;
  }
  body[data-theme="dark"] {
    --bg-color: #0b1020;
    --text-color: #f5f5f5;
    --card-bg: #161b2e;
    --accent: #90caf9;
    --accent-soft: #1e2746;
    --border-color: #394264;
  }
  body {
    font-family: Arial, sans-serif;
    margin: 2rem;
    background: var(--bg-color);
    color: var(--text-color);
  }
  h1 { color: var(--accent); }
  h2 { color: var(--accent); }
  .card {
    background: var(--card-bg);
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid var(--border-color);
  }
  .perf-table, .summary-table, .compare-table {
    border-collapse: collapse;
    width: 100%;
    margin-top: 1rem;
    font-size: 0.9rem;
  }
  .perf-table th, .summary-table th, .compare-table th {
    background: var(--accent-soft);
    padding: 8px;
    border: 1px solid var(--border-color);
    text-align: center;
  }
  .perf-table td, .summary-table td, .compare-table td {
    padding: 6px;
    border: 1px solid var(--border-color);
    text-align: center;
  }
  img {
    max-width: 650px;
    border: 1px solid var(--border-color);
    background: var(--card-bg);
    padding: 4px;
    margin: 8px;
  }
  .toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
  }
  .btn {
    border-radius: 4px;
    border: 1px solid var(--border-color);
    background: var(--accent-soft);
    color: var(--accent);
    padding: 0.4rem 0.8rem;
    cursor: pointer;
    font-size: 0.9rem;
  }
  .btn:hover {
    filter: brightness(1.05);
  }
  .slider-row {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 0.5rem;
  }
  .slider-row input[type="range"] {
    flex: 1;
  }
  </style>
</head>
<body data-theme="light">
<div class="toolbar">
  <h1>Dashboard ‚Äì Serveur Haute Performance</h1>
  <div>
    <button id="themeToggle" class="btn">Basculer mode sombre</button>
  </div>
</div>
<div class="card">
<h2>R√©sum√© statistique</h2>
<table class="dataframe summary-table">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>D√©bit moyen (req/s)</th>
      <th>Latence P99 moyenne (ms)</th>
      <th>CPU moyen (%)</th>
      <th>M√©moire moyenne (MB)</th>
    </tr>
    <tr>
      <th>server</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mono</th>
      <td>14.77</td>
      <td>4011.51</td>
      <td>0.07</td>
      <td>1.69</td>
    </tr>
    <tr>
      <th>multi</th>
      <td>129.34</td>
      <td>858.87</td>
      <td>0.96</td>
      <td>1.85</td>
    </tr>
  </tbody>
</table>
</div>
<div class="card">
<h2>üß† Analyse avanc√©e des performances</h2>
<p>Globalement, les mesures de benchmark montrent que le serveur multi-thread offre un d√©bit moyen d‚Äôenviron 129.3 requ√™tes par seconde, contre 14.8 req/s pour le serveur mono-thread. Sur l‚Äôensemble des configurations test√©es, cela correspond √† un gain moyen de performance d‚Äôenviron 8.76√ó en faveur de l‚Äôarchitecture multi-thread.</p>
<p>En termes de latence, la mesure P99 (latence subie par les 1 % de requ√™tes les plus lentes) reste plus favorable au serveur multi-thread, avec une P99 moyenne de 858.9 ms contre 4011.5 ms pour le mono-thread. Cela indique que le multi-thread absorbe mieux les pics de charge et r√©duit les ph√©nom√®nes de saturation lorsque le nombre de clients simultan√©s augmente.</p>
<p>√Ä la charge la plus √©lev√©e (‚âà 300 clients), on observe un d√©bit de 140.9 req/s pour le serveur multi-thread contre 9.2 req/s pour le mono-thread. La latence P99 atteint 5938.0 ms c√¥t√© mono, alors qu‚Äôelle est de 1925.2 ms c√¥t√© multi, ce qui confirme que le mono-thread atteint rapidement un plateau de performance tandis que le multi-thread continue √† exploiter les c≈ìurs CPU disponibles.</p>
<p>L‚Äôanalyse de l‚Äôutilisation CPU montre que les deux architectures finissent par saturer les c≈ìurs disponibles, mais le serveur multi-thread parvient √† transformer cette consommation CPU en d√©bit utile plus √©lev√© (CPU moyen ‚âà 1.0 % contre 0.1 % pour le mono-thread). La consommation m√©moire reste globalement ma√Ætris√©e pour les deux serveurs, avec une l√©g√®re surconsommation attendue c√¥t√© multi-thread li√©e √† la gestion des threads et de la file FIFO.</p>
<p>En pratique, l‚Äôarchitecture multi-thread avec file FIFO born√©e constitue le meilleur choix pour un environnement de production soumis √† des pics de charge importants, √† condition de ma√Ætriser la complexit√© de synchronisation et l‚Äôarr√™t propre des threads. Le serveur mono-thread conserve n√©anmoins un int√©r√™t p√©dagogique fort et peut √™tre adapt√© √† des sc√©narios simples ou √† faible charge, o√π la lisibilit√© du code prime sur la performance brute.</p>
</div>
<div class="card">
<h2>‚öñ Comparateur interactif Mono vs Multi</h2>
<p>Choisis un nombre de clients pour comparer les m√©triques entre le serveur mono-thread et le multi-thread. Le point de mesure le plus proche sera utilis√© pour chaque serveur.</p>
<div class="slider-row">
  <label for="clientSlider">Nombre de clients :</label>
  <input type="range" id="clientSlider" min="10" max="300" step="1" value="10">
  <span id="clientValue"></span>
</div>
<div id="compareOutput" style="margin-top:1rem;"></div>
</div>
<div class="card">
<h2>üìà Graphiques de performance</h2>
<div><img src="figures/1-throughput.png" alt="1-throughput.png"></div>
<div><img src="figures/2-latency_p99.png" alt="2-latency_p99.png"></div>
<div><img src="figures/3-cpu.png" alt="3-cpu.png"></div>
<div><img src="figures/4-memory.png" alt="4-memory.png"></div>
<div><img src="figures/5-speedup.png" alt="5-speedup.png"></div>
<div><img src="figures/6-saturation.png" alt="6-saturation.png"></div>
<div><img src="figures/THROUGHPUT_LIVE.png" alt="THROUGHPUT_LIVE.png"></div>
</div>
<script>
const DATA = [{"server": "mono", "clients": 10, "success": 10, "fail": 0, "mean": 330.1941919991805, "median": 305.42486750164244, "p95": 526.4645849965746, "p99": 526.4645849965746, "max_latency": 556.6404240016709, "cpu_mean": 0.0, "cpu_max": 0.0, "mem_mean": 1.6875, "mem_max": 1.6875, "throughput_rps": 17.43425112393098, "time_total": 0.5735835700033931}, {"server": "mono", "clients": 50, "success": 50, "fail": 0, "mean": 1384.7672498800239, "median": 1327.0869830012089, "p95": 2528.4918590004963, "p99": 2574.219467001967, "max_latency": 2658.3924549995572, "cpu_mean": 0.0, "cpu_max": 0.0, "mem_mean": 1.6875, "mem_max": 1.6875, "throughput_rps": 18.60651288028302, "time_total": 2.687231095998868}, {"server": "mono", "clients": 100, "success": 100, "fail": 0, "mean": 2661.5776266399553, "median": 2610.5125509984646, "p95": 5011.572424002225, "p99": 5155.3130710017285, "max_latency": 5225.894118000724, "cpu_mean": 0.0, "cpu_max": 0.0, "mem_mean": 1.6875, "mem_max": 1.6875, "throughput_rps": 18.98822092677711, "time_total": 5.266422820001026}, {"server": "mono", "clients": 200, "success": 107, "fail": 93, "mean": 3112.191511794391, "median": 3072.1926240003086, "p95": 5687.106933997711, "p99": 5863.533826999628, "max_latency": 5988.076485999045, "cpu_mean": 0.3553571428571428, "cpu_max": 19.9, "mem_mean": 1.6875, "mem_max": 1.6875, "throughput_rps": 9.614201812826616, "time_total": 11.12936904000162}, {"server": "mono", "clients": 300, "success": 103, "fail": 197, "mean": 2921.0766473298613, "median": 2865.3496080005425, "p95": 5743.183495000267, "p99": 5938.007183998707, "max_latency": 6054.561880002439, "cpu_mean": 0.0, "cpu_max": 0.0, "mem_mean": 1.68359375, "mem_max": 1.68359375, "throughput_rps": 9.214867195696954, "time_total": 11.177589195001929}, {"server": "multi", "clients": 10, "success": 10, "fail": 0, "mean": 71.54464939958416, "median": 73.19757899858814, "p95": 99.25550299885799, "p99": 99.25550299885799, "max_latency": 100.25805599798332, "cpu_mean": 0.0, "cpu_max": 0.0, "mem_mean": 1.83984375, "mem_max": 1.83984375, "throughput_rps": 96.43655361956611, "time_total": 0.10369512000033865}, {"server": "multi", "clients": 50, "success": 50, "fail": 0, "mean": 199.05023520033865, "median": 207.3923765001382, "p95": 365.8778360004362, "p99": 395.1182089986105, "max_latency": 401.5056500029459, "cpu_mean": 0.0, "cpu_max": 0.0, "mem_mean": 1.83984375, "mem_max": 1.83984375, "throughput_rps": 116.19795710887585, "time_total": 0.430300163996435}, {"server": "multi", "clients": 100, "success": 100, "fail": 0, "mean": 320.54384050996305, "median": 312.95837049947295, "p95": 586.6472959969542, "p99": 613.2527979971201, "max_latency": 617.9774029988039, "cpu_mean": 2.475, "cpu_max": 9.9, "mem_mean": 1.8515625, "mem_max": 1.8515625, "throughput_rps": 148.89162380339857, "time_total": 0.671629453998321}, {"server": "multi", "clients": 200, "success": 200, "fail": 0, "mean": 651.4613199100313, "median": 656.3113079992036, "p95": 1192.4681670025166, "p99": 1261.5276950018597, "max_latency": 1277.9497250012355, "cpu_mean": 1.4142857142857144, "cpu_max": 9.9, "mem_mean": 1.85546875, "mem_max": 1.85546875, "throughput_rps": 144.25108883460084, "time_total": 1.386471336998511}, {"server": "multi", "clients": 300, "success": 300, "fail": 0, "mean": 968.3648300433803, "median": 946.6423849989951, "p95": 1845.069142000284, "p99": 1925.1772989991878, "max_latency": 1997.3126490003779, "cpu_mean": 0.9090909090909091, "cpu_max": 10.0, "mem_mean": 1.8515625, "mem_max": 1.8515625, "throughput_rps": 140.9232450455949, "time_total": 2.1288184209988685}];
const MIN_CLIENTS = 10;
const MAX_CLIENTS = 300;

function getNearestRow(clients, server) {
  const filtered = DATA.filter(r => r.server === server);
  if (filtered.length === 0) return null;
  let best = filtered[0];
  let bestDiff = Math.abs(filtered[0].clients - clients);
  for (let i = 1; i < filtered.length; i++) {
    const d = Math.abs(filtered[i].clients - clients);
    if (d < bestDiff) {
      bestDiff = d;
      best = filtered[i];
    }
  }
  return best;
}

function updateCompare() {
  const slider = document.getElementById("clientSlider");
  const valueSpan = document.getElementById("clientValue");
  const out = document.getElementById("compareOutput");
  if (!slider || !out || !valueSpan) return;

  const clients = parseInt(slider.value);
  valueSpan.textContent = clients;

  const mono = getNearestRow(clients, "mono");
  const multi = getNearestRow(clients, "multi");

  if (!mono || !multi) {
    out.innerHTML = "<p>Donn√©es insuffisantes pour cette configuration.</p>";
    return;
  }

  const thMono = mono.throughput_rps || 0.0;
  const thMulti = multi.throughput_rps || 0.0;
  const p99Mono = mono.p99 || 0.0;
  const p99Multi = multi.p99 || 0.0;
  const cpuMono = (mono.cpu_mean === null || mono.cpu_mean === undefined) ? 0.0 : mono.cpu_mean;
  const cpuMulti = (multi.cpu_mean === null || multi.cpu_mean === undefined) ? 0.0 : multi.cpu_mean;
  const memMono = (mono.mem_mean === null || mono.mem_mean === undefined) ? 0.0 : mono.mem_mean;
  const memMulti = (multi.mem_mean === null || multi.mem_mean === undefined) ? 0.0 : multi.mem_mean;

  const speedup = thMono > 0 ? (thMulti / thMono) : 0.0;

  out.innerHTML =
    '<table class="compare-table">' +
      '<thead><tr>' +
        '<th>M√©trique</th>' +
        '<th>Mono-thread</th>' +
        '<th>Multi-thread</th>' +
      '</tr></thead>' +
      '<tbody>' +
        '<tr><td>Clients (point le plus proche)</td>' +
          '<td>' + mono.clients + '</td>' +
          '<td>' + multi.clients + '</td></tr>' +
        '<tr><td>D√©bit (req/s)</td>' +
          '<td>' + thMono.toFixed(1) + '</td>' +
          '<td>' + thMulti.toFixed(1) + '</td></tr>' +
        '<tr><td>Latence P99 (ms)</td>' +
          '<td>' + p99Mono.toFixed(1) + '</td>' +
          '<td>' + p99Multi.toFixed(1) + '</td></tr>' +
        '<tr><td>CPU moyen (%)</td>' +
          '<td>' + cpuMono.toFixed(1) + '</td>' +
          '<td>' + cpuMulti.toFixed(1) + '</td></tr>' +
        '<tr><td>M√©moire moyenne (MB)</td>' +
          '<td>' + memMono.toFixed(1) + '</td>' +
          '<td>' + memMulti.toFixed(1) + '</td></tr>' +
        '<tr><td>Speedup multi / mono (d√©bit)</td>' +
          '<td colspan="2">' + speedup.toFixed(2) + '√ó</td></tr>' +
      '</tbody>' +
    '</table>';
}

function initTheme() {
  const saved = window.localStorage.getItem("dashboardTheme");
  const body = document.body;
  if (saved === "dark") {
    body.setAttribute("data-theme", "dark");
  } else {
    body.setAttribute("data-theme", "light");
  }
}

function toggleTheme() {
  const body = document.body;
  const current = body.getAttribute("data-theme") || "light";
  const next = (current === "light") ? "dark" : "light";
  body.setAttribute("data-theme", next);
  window.localStorage.setItem("dashboardTheme", next);
}

document.addEventListener("DOMContentLoaded", function () {
  initTheme();
  const slider = document.getElementById("clientSlider");
  if (slider) {
    slider.addEventListener("input", updateCompare);
    updateCompare();
  }
  const btn = document.getElementById("themeToggle");
  if (btn) {
    btn.addEventListener("click", toggleTheme);
  }
});

</script>
</body>
</html>